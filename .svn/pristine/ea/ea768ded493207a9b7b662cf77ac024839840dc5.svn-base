/**
 * @lordfriend/nya-bootstrap-select v2.2.0
 * Copyright 2014 Nyasoft
 * Licensed under MIT license
 */
!function(){"use strict";function a(){return++j}function b(a){return a&&a.window===a}function c(a){return"string"==typeof a}function d(a){if(null==a||b(a))return!1;var d=a.length;return!(1!==a.nodeType||!d)||(c(a)||Array.isArray(a)||0===d||"number"==typeof d&&d>0&&d-1 in a)}function e(){return Object.create(null)}function f(b,c){var d,e=typeof b;return"function"==e||"object"==e&&null!==b?"function"==typeof(d=b.$$hashKey)?d=b.$$hashKey():void 0===d&&(d=b.$$hashKey=(c||a)()):d=b,e+":"+d}function g(a,b,c){var d,e,f=[],g=[];for(d=0;d<b.length;d++)for(e=0;e<a.length;e++)a[e][c]?a[e][c]===b[d]&&g.push(a[e]):f.push(a[e]);return g=g.concat(f)}function h(a){var b=a[0],c=a[a.length-1],d=[b];do{if(!(b=b.nextSibling))break;d.push(b)}while(b!==c);return angular.element(d)}function i(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}var j=0,k=function(a){return a.clone[0]},l=function(a){return a.clone[a.clone.length-1]},m=function(a,b,c,d,e,f,g,h){a[c]=d,e&&(a[e]=f),a.$index=b,a.$first=0===b,a.$last=b===g-1,a.$middle=!(a.$first||a.$last),a.$odd=!(a.$even=0==(1&b)),h&&(a.$group=h)},n=function(a,b){a.data("isolateScope",b)},o=function(a,b){var c,d=a.length;if(0===d)return!1;for(c=0;c<d;c++)if(v(b,a[c]))return!0;return!1},p=function(a,b){var c,d=a.length;if(0===d)return-1;for(c=0;c<d;c++)if(v(b,a[c]))return c;return-1},q=function(a,b,c){var d,e=a,f=typeof c;if(a==b)return null;do{if("string"===f){if(d=" "+e.className+" ",1===e.nodeType&&d.replace(/[\t\r\n\f]/g," ").indexOf(c)>=0)return e}else if(e==c)return e}while((e=e.parentNode)&&e!=b&&9!==e.nodeType);return null},r=function(a){var b;b=a.className.replace(/[\t\r\n\f]/g," ").trim().split(" ");for(var c=0;c<b.length;c++)/\s+/.test(b[c])&&(b.splice(c,1),c--);return b},s=function(a,b){return r(a).indexOf(b)!==-1},t=function(a,b){var c,d,e;if(a.text().toLowerCase().indexOf(b.toLowerCase())!==-1)return!0;for(c=a.children(),e=c.length,d=0;d<e;d++)if(c.eq(d).text().toLowerCase().indexOf(b.toLowerCase())!==-1)return!0;return!1},u=angular.element,v=angular.equals,w=angular.copy,x=angular.extend,y=angular.module("nya.bootstrap.select",[]);y.provider("nyaBsConfig",function(){var a=null,b={"en-us":{defaultNoneSelection:"Nothing selected",noSearchResult:"NO SEARCH RESULT",numberItemSelected:"%d items selected",selectAll:"Select All",deselectAll:"Deselect All"}},c=w(b);this.setLocalizedText=function(a,b){if(!a)throw new Error("localeId must be a string formatted as languageId-countryId");c[a]||(c[a]={}),c[a]=x(c[a],b)},this.useLocale=function(b){a=b},this.$get=["$locale",function(d){var e;return e=a?c[a]:c[d.id],e||(e=b["en-us"]),e}]}),y.controller("nyaBsSelectCtrl",function(){var a=this;a.keyIdentifier=null,a.valueIdentifier=null,a.isMultiple=!1,a.onCollectionChange=function(){},a.setId=function(b){a.id=b||"id#"+Math.floor(1e4*Math.random())}}),y.directive("nyaBsSelect",["$parse","$document","$timeout","$compile","nyaBsConfig",function(a,b,c,d,e){var f='<li class="no-search-result"><span>NO SEARCH RESULT</span></li>',g='<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">SELECT ALL</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">DESELECT ALL</button></div></div>';return{restrict:"ECA",require:["ngModel","nyaBsSelect"],controller:"nyaBsSelectCtrl",compile:function(h,j){h.addClass("btn-group");var k,l,m,n,x,y,z,A,B=function(a){var b;return b=j.titleTpl?u(j.titleTpl):j.title?document.createTextNode(j.title):G.defaultNoneSelectionTpl?u(G.defaultNoneSelectionTpl):G.defaultNoneSelection?document.createTextNode(G.defaultNoneSelection):document.createTextNode("Nothing selected"),a&&(j.titleTpl||G.defaultNoneSelectionTpl)?d(b)(a):b},C=h.children(),D=u('<button class="btn btn-default dropdown-toggle" type="button"><span class="pull-left filter-option"></span><span class="pull-left special-title"></span>&nbsp;<span class="caret"></span></button>'),E=u('<div class="dropdown-menu open"></div>'),F=u('<ul class="dropdown-menu inner"></ul>'),G=e,H=void 0!==j.multiple;for(n=r(h[0]),n.forEach(function(a){/btn-(?:primary|info|success|warning|danger|inverse)/.test(a)&&(h.removeClass(a),D.removeClass("btn-default"),D.addClass(a)),/btn-(?:lg|sm|xs)/.test(a)&&(h.removeClass(a),D.addClass(a))}),F.append(C),x=C.length,y=0;y<x;y++)z=C.eq(y),(z.hasClass("nya-bs-option")||z.attr("nya-bs-option"))&&(z.find("a").attr("tabindex","0"),A=z.attr("value"),angular.isString(A)&&""!==A&&(z.attr("data-value",A),z.removeAttr("value")));return"true"===j.liveSearch&&(k=u('<div class="bs-searchbox"><input type="text" class="form-control"></div>'),j.noSearchTitle?f=f.replace("NO SEARCH RESULT",j.noSearchTitle):j.noSearchTitleTpl?f=f.replace("NO SEARCH RESULT",j.noSearchTitleTpl):G.noSearchResultTpl?f=f.replace("NO SEARCH RESULT",G.noSearchResultTpl):G.noSearchResult&&(f=f.replace("NO SEARCH RESULT",G.noSearchResult)),l=u(f),E.append(k),F.append(l)),"true"===j.actionsBox&&H&&(G.selectAllTpl?g=g.replace("SELECT ALL",G.selectAllTpl):G.selectAll&&(g=g.replace("SELECT ALL",G.selectAll)),G.deselectAllTpl?g=g.replace("DESELECT ALL",G.deselectAllTpl):G.selectAll&&(g=g.replace("DESELECT ALL",G.deselectAll)),m=u(g),E.append(m)),u(D[0].querySelector(".special-title")).append(B()),E.append(F),h.append(D),h.append(E),function(e,f,g,h){function j(){var a,b,c=N.children(),d=c.length;for(a=0;a<d;a++)if(b=c.eq(a),b.hasClass("active")&&b.hasClass("nya-bs-option")&&!b.hasClass("not-match"))return b;return null}function k(a){for(var b,c=a.childNodes,d=c.length,e=0;e<d;e++)if(b=c[e],1===b.nodeType&&"a"===b.tagName.toLowerCase()){b.focus();break}}function l(a){var b=document.createElement("div");b.innerHTML=["&shy;","<style>",a,"{}","</style>"].join(""),b=document.body.appendChild(b);var c=b.getElementsByTagName("style")[0];if(c&&c.sheet&&c.sheet.rules&&c.sheet.cssRules){var d=!!(c.sheet.rules||c.sheet.cssRules)[0];return document.body.removeChild(b),d}return!1}function m(a){var b;if(b=a?N.children().eq(0):N.children().eq(N.children().length-1),l(".selected:not(.not-match)")){var c=N[0].querySelector(".selected:not(.not-match)");if(c)return c}else for(var d=0;d<N.children().length;d++){var e=N.children().eq(d);if(!e.hasClass("not-match")&&e.hasClass("selected"))return N.children().eq(d)[0]}return!b.hasClass("nya-bs-option")||b.hasClass("disabled")||b.hasClass("not-match")?a?n(b[0],"nextSibling"):n(b[0],"previousSibling"):b[0]}function n(a,b){if(!a||s(a,"nya-bs-option")){for(var c=a;(c=i(c,b))&&c.nodeType;)if(s(c,"nya-bs-option")&&!s(c,"disabled")&&!s(c,"not-match"))return c;return null}}function r(a){if(K&&!I){var b,c,d;if(b=N[0].querySelectorAll(".nya-bs-option"),b.length>0){c=F.$viewValue,d=Array.isArray(c)?w(c):[];for(var f=0;f<b.length;f++){var g=u(b[f]);if(!g.hasClass("disabled")&&!g.hasClass("not-match")){var h,i;void 0!==(h=y(g))&&(i=p(d,h),a&&i==-1?(d.push(h),g.addClass("selected")):a||i==-1||(d.splice(i,1),g.removeClass("selected")))}}F.$setViewValue(d),e.$digest(),A()}}}function x(a){var b,c,d,g=F.$viewValue;b=y(a),void 0!==b&&(K?(c=Array.isArray(g)?w(g):[],d=p(c,b),d===-1?(c.push(b),a.addClass("selected")):(c.splice(d,1),a.removeClass("selected"))):(N.children().removeClass("selected"),c=b,a.addClass("selected"))),F.$setViewValue(c),e.$digest(),K||(f.hasClass("open")&&f.triggerHandler("blur"),f.removeClass("open"),L[0].focus()),A()}function y(a){var b;return E?(b=a.data("isolateScope"),E(b)):H.valueIdentifier||H.keyIdentifier?(b=a.data("isolateScope"),b[H.valueIdentifier]||b[H.keyIdentifier]):a.attr("data-value")}function z(a){var b=a.find("a");return 0===b.children().length||b.children().eq(0).hasClass("check-mark")?b[0].firstChild.cloneNode(!1):b.children().eq(0)[0].cloneNode(!0)}function A(){var a=F.$viewValue;f.triggerHandler("change");var b=u(L[0].querySelector(".filter-option"));if(u(L[0].querySelector(".special-title")),void 0===a)return L.addClass("show-special-title"),void b.empty();K&&0===a.length?(L.addClass("show-special-title"),b.empty()):(L.removeClass("show-special-title"),c(function(){var c,e,f,h,i,j,k,l=N.children(),m=l.length,n=[],p=[];if(K&&"count"===g.selectedTextFormat?j=1:K&&g.selectedTextFormat&&(i=g.selectedTextFormat.match(/\s*count\s*>\s*(\d+)\s*/))&&(j=parseInt(i[1],10)),void 0!==j&&a.length>j)return b.empty(),void(G.numberItemSelectedTpl?b.append(u(G.numberItemSelectedTpl.replace("%d",a.length))):G.numberItemSelected?b.append(document.createTextNode(G.numberItemSelected.replace("%d",a.length))):b.append(document.createTextNode(a.length+" items selected")));for(f=0;f<m;f++)e=l.eq(f),e.hasClass("nya-bs-option")&&(c=y(e),K?Array.isArray(a)&&o(a,c)&&(h=e.attr("title"),h?n.push(document.createTextNode(h)):(n.push(z(e)),p.push(e.data("isolateScope")))):v(a,c)&&(h=e.attr("title"),h?n.push(document.createTextNode(h)):(n.push(z(e)),p.push(e.data("isolateScope")))));if(0===n.length)b.empty(),L.addClass("show-special-title");else if(1===n.length)L.removeClass("show-special-title"),b.empty(),k=p[0]?d(n[0])(p[0]):n[0],b.append(k);else for(L.removeClass("show-special-title"),b.empty(),f=0;f<n.length;f++)k=p[f]?d(n[f])(p[f]):n[f],b.append(k),f<n.length-1&&b.append(document.createTextNode(", "))}))}function B(){var a,b,c=N.find("li"),d=c.length;for(b=0;b<d;b++)if(a=c.eq(b),a.hasClass("nya-bs-option")||a.attr("nya-bs-option")){C=a[0].clientHeight;break}if(/\d+/.test(g.size)){var e=parseInt(g.size,10);N.css("max-height",e*C+"px"),N.css("overflow-y","auto")}}var C,D,E,F=h[0],H=h[1],I=!1,J=a(H.valueExp),K=void 0!==g.multiple,L=u(f[0].querySelector(".dropdown-toggle")),M=L.next(),N=u(M[0].querySelector(".dropdown-menu.inner")),O=u(M[0].querySelector(".bs-searchbox")),P=u(N[0].querySelector(".no-search-result")),Q=u(M[0].querySelector(".bs-actionsbox"));H.valueExp&&(E=function(a,b){return J(a,b)}),H.setId(f.attr("id")),K&&(H.isMultiple=!0,F.$isEmpty=function(a){return!a||0===a.length}),void 0!==g.disabled&&e.$watch(g.disabled,function(a){a?(L.addClass("disabled"),L.attr("disabled","disabled"),D=L.attr("tabindex"),L.attr("tabindex","-1"),I=!0):(L.removeClass("disabled"),L.removeAttr("disabled"),D?L.attr("tabindex",D):L.removeAttr("tabindex"),I=!1)}),H.onCollectionChange=function(a,b){var c,d=[],f=!1,g=w(F.$modelValue);if(g){if(Array.isArray(a)&&a.length>0){if(E)for(c=0;c<a.length;c++)d.push(E(e,a[c]));else for(c=0;c<a.length;c++)H.valueIdentifier?d.push(a[c][H.valueIdentifier]):H.keyIdentifier&&d.push(a[c][H.keyIdentifier]);if(K){for(c=0;c<g.length;c++)o(d,g[c])||(f=!0,g.splice(c,1),c--);f&&(F.$setViewValue(g),A())}else o(d,g)||(g=d[0],F.$setViewValue(g),A())}b&&A()}},N.on("click",function(a){if(!I&&!u(a.target).hasClass("dropdown-header")){var b,c=q(a.target,N[0],"nya-bs-option");if(null!==c){if(b=u(c),b.hasClass("disabled"))return;x(b)}}});var R=function(a){null===q(a.target,f.parent()[0],f[0])&&(f.hasClass("open")&&f.triggerHandler("blur"),f.removeClass("open"))};b.on("click",R),L.on("blur",function(){f.hasClass("open")||f.triggerHandler("blur")}),L.on("click",function(){var a;f.toggleClass("open"),f.hasClass("open")&&void 0===C&&B(),"true"===g.liveSearch&&f.hasClass("open")?(O.children().eq(0)[0].focus(),(a=m(!0))&&(N.children().removeClass("active"),u(a).addClass("active"))):f.hasClass("open")&&(a=m(!0))&&k(a)}),"true"===g.actionsBox&&K&&(Q.find("button").eq(0).on("click",function(){r(!0)}),Q.find("button").eq(1).on("click",function(){r(!1)})),"true"===g.liveSearch&&O.children().on("input",function(){var a,b,c,d=O.children().val(),e=0,f=N.children(),g=f.length;if(d){for(a=0;a<g;a++)b=f.eq(a),b.hasClass("nya-bs-option")&&(t(b.find("a"),d)?(b.removeClass("not-match"),e++):b.addClass("not-match"));0===e?P.addClass("show"):P.removeClass("show")}else{for(a=0;a<g;a++)b=f.eq(a),b.hasClass("nya-bs-option")&&b.removeClass("not-match");P.removeClass("show")}(c=m(!0))&&(f.removeClass("active"),u(c).addClass("active"))}),F.$render=function(){var a,b,c=F.$modelValue,d=N.children(),e=d.length;if(void 0===c)for(a=0;a<e;a++)d.eq(a).hasClass("nya-bs-option")&&d.eq(a).removeClass("selected");else for(a=0;a<e;a++)d.eq(a).hasClass("nya-bs-option")&&(b=y(d.eq(a)),K?o(c,b)?d.eq(a).addClass("selected"):d.eq(a).removeClass("selected"):v(c,b)?d.eq(a).addClass("selected"):d.eq(a).removeClass("selected"));A()},f.on("keydown",function(a){var b=a.keyCode;if(27===b||13===b||38===b||40===b){if(a.preventDefault(),I)return void a.stopPropagation();var c,d,e,h,i=q(a.target,f[0],L[0]);"true"===g.liveSearch?d=q(a.target,f[0],O[0]):c=q(a.target,f[0],M[0]),i?13!==b&&38!==b&&40!==b||f.hasClass("open")||(a.stopPropagation(),f.addClass("open"),void 0===C&&B(),"true"===g.liveSearch?(O.children().eq(0)[0].focus(),(h=m(!0))&&(N.children().removeClass("active"),u(h).addClass("active"))):(h=m(!0))&&k(h)):c?27===b?(L[0].focus(),f.hasClass("open")&&f.triggerHandler("blur"),f.removeClass("open"),a.stopPropagation()):38===b?(a.stopPropagation(),h=n(a.target.parentNode,"previousSibling"),h?k(h):(h=m(!1))&&k(h)):40===b?(a.stopPropagation(),h=n(a.target.parentNode,"nextSibling"),h?k(h):(h=m(!0))&&k(h)):13===b&&(a.stopPropagation(),e=u(a.target.parentNode),e.hasClass("nya-bs-option")&&(x(e),K||L[0].focus())):d&&(27===b?(L[0].focus(),f.removeClass("open"),a.stopPropagation()):38===b?(a.stopPropagation(),(e=j())&&(h=n(e[0],"previousSibling"),h?(e.removeClass("active"),u(h).addClass("active")):(h=m(!1))&&(e.removeClass("active"),u(h).addClass("active")))):40===b?(a.stopPropagation(),(e=j())&&(h=n(e[0],"nextSibling"),h?(e.removeClass("active"),u(h).addClass("active")):(h=m(!0))&&(e.removeClass("active"),u(h).addClass("active")))):13===b&&(e=j())&&(x(e),K||L[0].focus()))}}),e.$on("$destroy",function(){N.off(),L.off(),O.off&&O.off(),b.off("click",R)})}}}}]),y.directive("nyaBsOption",["$parse",function(a){var b=/^\s*(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/;return{restrict:"A",transclude:"element",priority:1e3,terminal:!0,require:["^nyaBsSelect","^ngModel"],compile:function(c,i){var j=i.nyaBsOption,p=document.createComment(" end nyaBsOption: "+j+" "),q=j.match(b);if(!q)throw new Error("invalid expression");var r,s,t,w,x,y=i.value,z=y?a(y):null,A=q[3]||q[1],B=q[2],C=q[4],D=q[5]?a(q[5]):null,E=q[6],F={$id:f},G={};return E?w=a(E):(r=function(a,b){return f(b)},s=function(a){return a}),function(a,b,c,f,i){function j(a){var c,f,j,w,y,z,C,D,F,G,J,L,M,N,O,P=b[0],Q=e(),R=[];if(x&&(L=[]),d(a))z=a,y=t||r;else{y=t||s,z=[];for(var S in a)a.hasOwnProperty(S)&&"$"!=S.charAt(0)&&z.push(S);z.sort()}for(C=z.length,D=new Array(C),c=0;c<C;c++)if(f=a===z?c:z[c],j=a[f],w=y(f,j,c),O={},B&&(O[B]=f),O[A]=j,R.push(O),x&&(G=x(f,j),L.indexOf(G)===-1&&G&&L.push(G)),K[w])F=K[w],delete K[w],x&&(F.group=G),F.key=f,F.value=j,Q[w]=F,D[c]=F;else{if(Q[w])throw D.forEach(function(a){a&&a.scope&&(K[a.id]=a)}),new Error("Duplicates in a select are not allowed. Use 'track by' expression to specify unique keys.");D[c]={id:w,scope:void 0,clone:void 0,key:f,value:j},Q[w]=!0,G&&(D[c].group=G)}L&&L.length>0&&(D=g(D,L,"group"));for(var T in K)F=K[T],N=h(F.clone),N.removeData("isolateScope"),N.remove(),F.scope.$destroy();for(c=0;c<C;c++)F=D[c],F.scope?(J=P,k(F)!=J&&u(P).after(F.clone),P=l(F),m(F.scope,c,A,F.value,B,F.key,C,F.group)):i(function(a,b){n(a,b),F.scope=b;var d=p.cloneNode(!1);a[a.length++]=d,u(P).after(a),a.addClass("nya-bs-option"),j=q?q(F.key,F.value):F.value||F.key,H.isMultiple?Array.isArray(I.$modelValue)&&o(I.$modelValue,j)&&a.addClass("selected"):v(j,I.$modelValue)&&a.addClass("selected"),P=d,F.clone=a,Q[F.id]=F,m(F.scope,c,A,F.value,B,F.key,C,F.group)}),L&&(M&&M===F.group?F.clone.removeClass("first-in-group"):F.clone.addClass("first-in-group"),M=F.group,F.clone.addClass("group-item"));K=Q,H.onCollectionChange(R,E)}var q,E,H=f[0],I=f[1],J={};w&&(t=function(b,c,d){return B&&(F[B]=b),F[A]=c,F.$index=d,w(a,F)}),D&&(x=function(b,c){return B&&(G[B]=b),G[A]=c,D(a,G)}),B&&(H.keyIdentifier=B),A&&(H.valueIdentifier=A),z&&(H.valueExp=y,q=function(b,c){return B&&(J[B]=b),J[A]=c,z(a,J)});var K=e();"true"===c.deepWatch?(E=!0,a.$watch(C,j,!0)):(E=!1,a.$watchCollection(C,j))}}}}])}();